function [kp2] = rot(kp, i, element, l, x, y, z, r, kp11, kp12, kp21, kp22);
% function [x1 y1 z1 x2 y2 z2 Ry Rz] = rot(kp, i, element, l, x, y, z, r, kp11, kp12, kp21, kp22);
x1 = x(element(i, 1), 1);
y1 = y(element(i, 1), 1);
z1 = z(element(i, 1), 1);
r1 = r(element(i, 1), 1);

x2 = x(element(i, 2), 1);
y2 = y(element(i, 2), 1);
z2 = z(element(i, 2), 1);
r2 = r(element(i, 2), 1);

len = sqrt((x2 - x1)^2 + (z2 - z1)^2 + (y2 - y1)^2);

theta_z = sqrt((x2 - x1)^2 + (z2 - z1)^2)/sqrt((x2 - x1)^2 + (z2 - z1)^2 + (y2 - y1)^2);

theta_y = (x2 - x1)/sqrt((x2 - x1)^2 + (z2 - z1)^2);
if theta_y == NaN
    theta_y = pi/2

theta_z = acos(theta_z)
theta_y = acos(theta_y)

Ry = [cos(theta_y) 0 sin(theta_y); 0 1 0; -sin(theta_y) 0 cos(theta_y)];
Rz = [cos(theta_z) -sin(theta_z) 0; sin(theta_z) cos(theta_z) 0; 0 0 1];

a = Ry*Rz;

kp11_4k(1, 1, 1, 1) = kp11(1, 1);
kp11_4k(1, 1, 1, 2) = kp11(1, 4);
kp11_4k(1, 1, 1, 3) = kp11(1, 5);
kp11_4k(1, 1, 2, 1) = kp11(1, 4);
kp11_4k(1, 1, 2, 2) = kp11(1, 2);
kp11_4k(1, 1, 2, 3) = kp11(1, 6);
kp11_4k(1, 1, 3, 1) = kp11(1, 5);
kp11_4k(1, 1, 3, 2) = kp11(1, 6);
kp11_4k(1, 1, 3, 3) = kp11(1, 3);

kp11_4k(1, 2, 1, 1) = kp11(4, 1);
kp11_4k(1, 2, 1, 2) = kp11(4, 4);
kp11_4k(1, 2, 1, 3) = kp11(4, 5);
kp11_4k(1, 2, 2, 1) = kp11(4, 4);
kp11_4k(1, 2, 2, 2) = kp11(4, 2);
kp11_4k(1, 2, 2, 3) = kp11(4, 6);
kp11_4k(1, 2, 3, 1) = kp11(4, 5);
kp11_4k(1, 2, 3, 2) = kp11(4, 6);
kp11_4k(1, 2, 3, 3) = kp11(4, 3);

kp11_4k(1, 3, 1, 1) = kp11(5, 1);
kp11_4k(1, 3, 1, 2) = kp11(5, 4);
kp11_4k(1, 3, 1, 3) = kp11(5, 5);
kp11_4k(1, 3, 2, 1) = kp11(5, 4);
kp11_4k(1, 3, 2, 2) = kp11(5, 2);
kp11_4k(1, 3, 2, 3) = kp11(5, 6);
kp11_4k(1, 3, 3, 1) = kp11(5, 5);
kp11_4k(1, 3, 3, 2) = kp11(5, 6);
kp11_4k(1, 3, 3, 3) = kp11(5, 3);

kp11_4k(2, 1, 1, 1) = kp11_4k(1, 2, 1, 1);
kp11_4k(2, 1, 1, 2) = kp11_4k(1, 2, 1, 2);
kp11_4k(2, 1, 1, 3) = kp11_4k(1, 2, 1, 3);
kp11_4k(2, 1, 2, 1) = kp11_4k(1, 2, 2, 1);
kp11_4k(2, 1, 2, 2) = kp11_4k(1, 2, 2, 2);
kp11_4k(2, 1, 2, 3) = kp11_4k(1, 2, 2, 3);
kp11_4k(2, 1, 3, 1) = kp11_4k(1, 2, 3, 1);
kp11_4k(2, 1, 3, 2) = kp11_4k(1, 2, 3, 2);
kp11_4k(2, 1, 3, 3) = kp11_4k(1, 2, 3, 3);

kp11_4k(2, 2, 1, 1) = kp11(2, 1);
kp11_4k(2, 2, 1, 2) = kp11(2, 4);
kp11_4k(2, 2, 1, 3) = kp11(2, 5);
kp11_4k(2, 2, 2, 1) = kp11(2, 4);
kp11_4k(2, 2, 2, 2) = kp11(2, 2);
kp11_4k(2, 2, 2, 3) = kp11(2, 6);
kp11_4k(2, 2, 3, 1) = kp11(2, 5);
kp11_4k(2, 2, 3, 2) = kp11(2, 6);
kp11_4k(2, 2, 3, 3) = kp11(2, 3);

kp11_4k(2, 3, 1, 1) = kp11(6, 1);
kp11_4k(2, 3, 1, 2) = kp11(6, 4);
kp11_4k(2, 3, 1, 3) = kp11(6, 5);
kp11_4k(2, 3, 2, 1) = kp11(6, 4);
kp11_4k(2, 3, 2, 2) = kp11(6, 2);
kp11_4k(2, 3, 2, 3) = kp11(6, 6);
kp11_4k(2, 3, 3, 1) = kp11(6, 5);
kp11_4k(2, 3, 3, 2) = kp11(6, 6);
kp11_4k(2, 3, 3, 3) = kp11(6, 3);

kp11_4k(3, 1, 1, 1) = kp11_4k(1, 3, 1, 1);
kp11_4k(3, 1, 1, 2) = kp11_4k(1, 3, 1, 2);
kp11_4k(3, 1, 1, 3) = kp11_4k(1, 3, 1, 3);
kp11_4k(3, 1, 2, 1) = kp11_4k(1, 3, 2, 1);
kp11_4k(3, 1, 2, 2) = kp11_4k(1, 3, 2, 2);
kp11_4k(3, 1, 2, 3) = kp11_4k(1, 3, 2, 3);
kp11_4k(3, 1, 3, 1) = kp11_4k(1, 3, 3, 1);
kp11_4k(3, 1, 3, 2) = kp11_4k(1, 3, 3, 2);
kp11_4k(3, 1, 3, 3) = kp11_4k(1, 3, 3, 3);

kp11_4k(3, 2, 1, 1) = kp11_4k(2, 3, 1, 1);
kp11_4k(3, 2, 1, 2) = kp11_4k(2, 3, 1, 2);
kp11_4k(3, 2, 1, 3) = kp11_4k(2, 3, 1, 3);
kp11_4k(3, 2, 2, 1) = kp11_4k(2, 3, 2, 1);
kp11_4k(3, 2, 2, 2) = kp11_4k(2, 3, 2, 2);
kp11_4k(3, 2, 2, 3) = kp11_4k(2, 3, 2, 3);
kp11_4k(3, 2, 3, 1) = kp11_4k(2, 3, 3, 1);
kp11_4k(3, 2, 3, 2) = kp11_4k(2, 3, 3, 2);
kp11_4k(3, 2, 3, 3) = kp11_4k(2, 3, 3, 3);

kp11_4k(3, 3, 1, 1) = kp11(3, 1);
kp11_4k(3, 3, 1, 2) = kp11(3, 4);
kp11_4k(3, 3, 1, 3) = kp11(3, 5);
kp11_4k(3, 3, 2, 1) = kp11(3, 4);
kp11_4k(3, 3, 2, 2) = kp11(3, 2);
kp11_4k(3, 3, 2, 3) = kp11(3, 6);
kp11_4k(3, 3, 3, 1) = kp11(3, 5);
kp11_4k(3, 3, 3, 2) = kp11(3, 6);
kp11_4k(3, 3, 3, 3) = kp11(3, 3);

kp12_4k(1, 1, 1, 1) = kp12(1, 1);
kp12_4k(1, 1, 1, 2) = kp12(1, 4);
kp12_4k(1, 1, 1, 3) = kp12(1, 5);
kp12_4k(1, 1, 2, 1) = kp12(1, 4);
kp12_4k(1, 1, 2, 2) = kp12(1, 2);
kp12_4k(1, 1, 2, 3) = kp12(1, 6);
kp12_4k(1, 1, 3, 1) = kp12(1, 5);
kp12_4k(1, 1, 3, 2) = kp12(1, 6);
kp12_4k(1, 1, 3, 3) = kp12(1, 3);

kp12_4k(1, 2, 1, 1) = kp12(4, 1);
kp12_4k(1, 2, 1, 2) = kp12(4, 4);
kp12_4k(1, 2, 1, 3) = kp12(4, 5);
kp12_4k(1, 2, 2, 1) = kp12(4, 4);
kp12_4k(1, 2, 2, 2) = kp12(4, 2);
kp12_4k(1, 2, 2, 3) = kp12(4, 6);
kp12_4k(1, 2, 3, 1) = kp12(4, 5);
kp12_4k(1, 2, 3, 2) = kp12(4, 6);
kp12_4k(1, 2, 3, 3) = kp12(4, 3);

kp12_4k(1, 3, 1, 1) = kp12(5, 1);
kp12_4k(1, 3, 1, 2) = kp12(5, 4);
kp12_4k(1, 3, 1, 3) = kp12(5, 5);
kp12_4k(1, 3, 2, 1) = kp12(5, 4);
kp12_4k(1, 3, 2, 2) = kp12(5, 2);
kp12_4k(1, 3, 2, 3) = kp12(5, 6);
kp12_4k(1, 3, 3, 1) = kp12(5, 5);
kp12_4k(1, 3, 3, 2) = kp12(5, 6);
kp12_4k(1, 3, 3, 3) = kp12(5, 3);

kp12_4k(2, 1, 1, 1) = kp12_4k(1, 2, 1, 1);
kp12_4k(2, 1, 1, 2) = kp12_4k(1, 2, 1, 2);
kp12_4k(2, 1, 1, 3) = kp12_4k(1, 2, 1, 3);
kp12_4k(2, 1, 2, 1) = kp12_4k(1, 2, 2, 1);
kp12_4k(2, 1, 2, 2) = kp12_4k(1, 2, 2, 2);
kp12_4k(2, 1, 2, 3) = kp12_4k(1, 2, 2, 3);
kp12_4k(2, 1, 3, 1) = kp12_4k(1, 2, 3, 1);
kp12_4k(2, 1, 3, 2) = kp12_4k(1, 2, 3, 2);
kp12_4k(2, 1, 3, 3) = kp12_4k(1, 2, 3, 3);

kp12_4k(2, 2, 1, 1) = kp12(2, 1);
kp12_4k(2, 2, 1, 2) = kp12(2, 4);
kp12_4k(2, 2, 1, 3) = kp12(2, 5);
kp12_4k(2, 2, 2, 1) = kp12(2, 4);
kp12_4k(2, 2, 2, 2) = kp12(2, 2);
kp12_4k(2, 2, 2, 3) = kp12(2, 6);
kp12_4k(2, 2, 3, 1) = kp12(2, 5);
kp12_4k(2, 2, 3, 2) = kp12(2, 6);
kp12_4k(2, 2, 3, 3) = kp12(2, 3);

kp12_4k(2, 3, 1, 1) = kp12(6, 1);
kp12_4k(2, 3, 1, 2) = kp12(6, 4);
kp12_4k(2, 3, 1, 3) = kp12(6, 5);
kp12_4k(2, 3, 2, 1) = kp12(6, 4);
kp12_4k(2, 3, 2, 2) = kp12(6, 2);
kp12_4k(2, 3, 2, 3) = kp12(6, 6);
kp12_4k(2, 3, 3, 1) = kp12(6, 5);
kp12_4k(2, 3, 3, 2) = kp12(6, 6);
kp12_4k(2, 3, 3, 3) = kp12(6, 3);

kp12_4k(3, 1, 1, 1) = kp12_4k(1, 3, 1, 1);
kp12_4k(3, 1, 1, 2) = kp12_4k(1, 3, 1, 2);
kp12_4k(3, 1, 1, 3) = kp12_4k(1, 3, 1, 3);
kp12_4k(3, 1, 2, 1) = kp12_4k(1, 3, 2, 1);
kp12_4k(3, 1, 2, 2) = kp12_4k(1, 3, 2, 2);
kp12_4k(3, 1, 2, 3) = kp12_4k(1, 3, 2, 3);
kp12_4k(3, 1, 3, 1) = kp12_4k(1, 3, 3, 1);
kp12_4k(3, 1, 3, 2) = kp12_4k(1, 3, 3, 2);
kp12_4k(3, 1, 3, 3) = kp12_4k(1, 3, 3, 3);

kp12_4k(3, 2, 1, 1) = kp12_4k(2, 3, 1, 1);
kp12_4k(3, 2, 1, 2) = kp12_4k(2, 3, 1, 2);
kp12_4k(3, 2, 1, 3) = kp12_4k(2, 3, 1, 3);
kp12_4k(3, 2, 2, 1) = kp12_4k(2, 3, 2, 1);
kp12_4k(3, 2, 2, 2) = kp12_4k(2, 3, 2, 2);
kp12_4k(3, 2, 2, 3) = kp12_4k(2, 3, 2, 3);
kp12_4k(3, 2, 3, 1) = kp12_4k(2, 3, 3, 1);
kp12_4k(3, 2, 3, 2) = kp12_4k(2, 3, 3, 2);
kp12_4k(3, 2, 3, 3) = kp12_4k(2, 3, 3, 3);

kp12_4k(3, 3, 1, 1) = kp12(3, 1);
kp12_4k(3, 3, 1, 2) = kp12(3, 4);
kp12_4k(3, 3, 1, 3) = kp12(3, 5);
kp12_4k(3, 3, 2, 1) = kp12(3, 4);
kp12_4k(3, 3, 2, 2) = kp12(3, 2);
kp12_4k(3, 3, 2, 3) = kp12(3, 6);
kp12_4k(3, 3, 3, 1) = kp12(3, 5);
kp12_4k(3, 3, 3, 2) = kp12(3, 6);
kp12_4k(3, 3, 3, 3) = kp12(3, 3);

kp21_4k(1, 1, 1, 1) = kp21(1, 1);
kp21_4k(1, 1, 1, 2) = kp21(1, 4);
kp21_4k(1, 1, 1, 3) = kp21(1, 5);
kp21_4k(1, 1, 2, 1) = kp21(1, 4);
kp21_4k(1, 1, 2, 2) = kp21(1, 2);
kp21_4k(1, 1, 2, 3) = kp21(1, 6);
kp21_4k(1, 1, 3, 1) = kp21(1, 5);
kp21_4k(1, 1, 3, 2) = kp21(1, 6);
kp21_4k(1, 1, 3, 3) = kp21(1, 3);

kp21_4k(1, 2, 1, 1) = kp21(4, 1);
kp21_4k(1, 2, 1, 2) = kp21(4, 4);
kp21_4k(1, 2, 1, 3) = kp21(4, 5);
kp21_4k(1, 2, 2, 1) = kp21(4, 4);
kp21_4k(1, 2, 2, 2) = kp21(4, 2);
kp21_4k(1, 2, 2, 3) = kp21(4, 6);
kp21_4k(1, 2, 3, 1) = kp21(4, 5);
kp21_4k(1, 2, 3, 2) = kp21(4, 6);
kp21_4k(1, 2, 3, 3) = kp21(4, 3);

kp21_4k(1, 3, 1, 1) = kp21(5, 1);
kp21_4k(1, 3, 1, 2) = kp21(5, 4);
kp21_4k(1, 3, 1, 3) = kp21(5, 5);
kp21_4k(1, 3, 2, 1) = kp21(5, 4);
kp21_4k(1, 3, 2, 2) = kp21(5, 2);
kp21_4k(1, 3, 2, 3) = kp21(5, 6);
kp21_4k(1, 3, 3, 1) = kp21(5, 5);
kp21_4k(1, 3, 3, 2) = kp21(5, 6);
kp21_4k(1, 3, 3, 3) = kp21(5, 3);

kp21_4k(2, 1, 1, 1) = kp21_4k(1, 2, 1, 1);
kp21_4k(2, 1, 1, 2) = kp21_4k(1, 2, 1, 2);
kp21_4k(2, 1, 1, 3) = kp21_4k(1, 2, 1, 3);
kp21_4k(2, 1, 2, 1) = kp21_4k(1, 2, 2, 1);
kp21_4k(2, 1, 2, 2) = kp21_4k(1, 2, 2, 2);
kp21_4k(2, 1, 2, 3) = kp21_4k(1, 2, 2, 3);
kp21_4k(2, 1, 3, 1) = kp21_4k(1, 2, 3, 1);
kp21_4k(2, 1, 3, 2) = kp21_4k(1, 2, 3, 2);
kp21_4k(2, 1, 3, 3) = kp21_4k(1, 2, 3, 3);

kp21_4k(2, 2, 1, 1) = kp21(2, 1);
kp21_4k(2, 2, 1, 2) = kp21(2, 4);
kp21_4k(2, 2, 1, 3) = kp21(2, 5);
kp21_4k(2, 2, 2, 1) = kp21(2, 4);
kp21_4k(2, 2, 2, 2) = kp21(2, 2);
kp21_4k(2, 2, 2, 3) = kp21(2, 6);
kp21_4k(2, 2, 3, 1) = kp21(2, 5);
kp21_4k(2, 2, 3, 2) = kp21(2, 6);
kp21_4k(2, 2, 3, 3) = kp21(2, 3);

kp21_4k(2, 3, 1, 1) = kp21(6, 1);
kp21_4k(2, 3, 1, 2) = kp21(6, 4);
kp21_4k(2, 3, 1, 3) = kp21(6, 5);
kp21_4k(2, 3, 2, 1) = kp21(6, 4);
kp21_4k(2, 3, 2, 2) = kp21(6, 2);
kp21_4k(2, 3, 2, 3) = kp21(6, 6);
kp21_4k(2, 3, 3, 1) = kp21(6, 5);
kp21_4k(2, 3, 3, 2) = kp21(6, 6);
kp21_4k(2, 3, 3, 3) = kp21(6, 3);

kp21_4k(3, 1, 1, 1) = kp21_4k(1, 3, 1, 1);
kp21_4k(3, 1, 1, 2) = kp21_4k(1, 3, 1, 2);
kp21_4k(3, 1, 1, 3) = kp21_4k(1, 3, 1, 3);
kp21_4k(3, 1, 2, 1) = kp21_4k(1, 3, 2, 1);
kp21_4k(3, 1, 2, 2) = kp21_4k(1, 3, 2, 2);
kp21_4k(3, 1, 2, 3) = kp21_4k(1, 3, 2, 3);
kp21_4k(3, 1, 3, 1) = kp21_4k(1, 3, 3, 1);
kp21_4k(3, 1, 3, 2) = kp21_4k(1, 3, 3, 2);
kp21_4k(3, 1, 3, 3) = kp21_4k(1, 3, 3, 3);

kp21_4k(3, 2, 1, 1) = kp21_4k(2, 3, 1, 1);
kp21_4k(3, 2, 1, 2) = kp21_4k(2, 3, 1, 2);
kp21_4k(3, 2, 1, 3) = kp21_4k(2, 3, 1, 3);
kp21_4k(3, 2, 2, 1) = kp21_4k(2, 3, 2, 1);
kp21_4k(3, 2, 2, 2) = kp21_4k(2, 3, 2, 2);
kp21_4k(3, 2, 2, 3) = kp21_4k(2, 3, 2, 3);
kp21_4k(3, 2, 3, 1) = kp21_4k(2, 3, 3, 1);
kp21_4k(3, 2, 3, 2) = kp21_4k(2, 3, 3, 2);
kp21_4k(3, 2, 3, 3) = kp21_4k(2, 3, 3, 3);

kp21_4k(3, 3, 1, 1) = kp21(3, 1);
kp21_4k(3, 3, 1, 2) = kp21(3, 4);
kp21_4k(3, 3, 1, 3) = kp21(3, 5);
kp21_4k(3, 3, 2, 1) = kp21(3, 4);
kp21_4k(3, 3, 2, 2) = kp21(3, 2);
kp21_4k(3, 3, 2, 3) = kp21(3, 6);
kp21_4k(3, 3, 3, 1) = kp21(3, 5);
kp21_4k(3, 3, 3, 2) = kp21(3, 6);
kp21_4k(3, 3, 3, 3) = kp21(3, 3);

kp22_4k(1, 1, 1, 1) = kp22(1, 1);
kp22_4k(1, 1, 1, 2) = kp22(1, 4);
kp22_4k(1, 1, 1, 3) = kp22(1, 5);
kp22_4k(1, 1, 2, 1) = kp22(1, 4);
kp22_4k(1, 1, 2, 2) = kp22(1, 2);
kp22_4k(1, 1, 2, 3) = kp22(1, 6);
kp22_4k(1, 1, 3, 1) = kp22(1, 5);
kp22_4k(1, 1, 3, 2) = kp22(1, 6);
kp22_4k(1, 1, 3, 3) = kp22(1, 3);

kp22_4k(1, 2, 1, 1) = kp22(4, 1);
kp22_4k(1, 2, 1, 2) = kp22(4, 4);
kp22_4k(1, 2, 1, 3) = kp22(4, 5);
kp22_4k(1, 2, 2, 1) = kp22(4, 4);
kp22_4k(1, 2, 2, 2) = kp22(4, 2);
kp22_4k(1, 2, 2, 3) = kp22(4, 6);
kp22_4k(1, 2, 3, 1) = kp22(4, 5);
kp22_4k(1, 2, 3, 2) = kp22(4, 6);
kp22_4k(1, 2, 3, 3) = kp22(4, 3);

kp22_4k(1, 3, 1, 1) = kp22(5, 1);
kp22_4k(1, 3, 1, 2) = kp22(5, 4);
kp22_4k(1, 3, 1, 3) = kp22(5, 5);
kp22_4k(1, 3, 2, 1) = kp22(5, 4);
kp22_4k(1, 3, 2, 2) = kp22(5, 2);
kp22_4k(1, 3, 2, 3) = kp22(5, 6);
kp22_4k(1, 3, 3, 1) = kp22(5, 5);
kp22_4k(1, 3, 3, 2) = kp22(5, 6);
kp22_4k(1, 3, 3, 3) = kp22(5, 3);

kp22_4k(2, 1, 1, 1) = kp22_4k(1, 2, 1, 1);
kp22_4k(2, 1, 1, 2) = kp22_4k(1, 2, 1, 2);
kp22_4k(2, 1, 1, 3) = kp22_4k(1, 2, 1, 3);
kp22_4k(2, 1, 2, 1) = kp22_4k(1, 2, 2, 1);
kp22_4k(2, 1, 2, 2) = kp22_4k(1, 2, 2, 2);
kp22_4k(2, 1, 2, 3) = kp22_4k(1, 2, 2, 3);
kp22_4k(2, 1, 3, 1) = kp22_4k(1, 2, 3, 1);
kp22_4k(2, 1, 3, 2) = kp22_4k(1, 2, 3, 2);
kp22_4k(2, 1, 3, 3) = kp22_4k(1, 2, 3, 3);

kp22_4k(2, 2, 1, 1) = kp22(2, 1);
kp22_4k(2, 2, 1, 2) = kp22(2, 4);
kp22_4k(2, 2, 1, 3) = kp22(2, 5);
kp22_4k(2, 2, 2, 1) = kp22(2, 4);
kp22_4k(2, 2, 2, 2) = kp22(2, 2);
kp22_4k(2, 2, 2, 3) = kp22(2, 6);
kp22_4k(2, 2, 3, 1) = kp22(2, 5);
kp22_4k(2, 2, 3, 2) = kp22(2, 6);
kp22_4k(2, 2, 3, 3) = kp22(2, 3);

kp22_4k(2, 3, 1, 1) = kp22(6, 1);
kp22_4k(2, 3, 1, 2) = kp22(6, 4);
kp22_4k(2, 3, 1, 3) = kp22(6, 5);
kp22_4k(2, 3, 2, 1) = kp22(6, 4);
kp22_4k(2, 3, 2, 2) = kp22(6, 2);
kp22_4k(2, 3, 2, 3) = kp22(6, 6);
kp22_4k(2, 3, 3, 1) = kp22(6, 5);
kp22_4k(2, 3, 3, 2) = kp22(6, 6);
kp22_4k(2, 3, 3, 3) = kp22(6, 3);

kp22_4k(3, 1, 1, 1) = kp22_4k(1, 3, 1, 1);
kp22_4k(3, 1, 1, 2) = kp22_4k(1, 3, 1, 2);
kp22_4k(3, 1, 1, 3) = kp22_4k(1, 3, 1, 3);
kp22_4k(3, 1, 2, 1) = kp22_4k(1, 3, 2, 1);
kp22_4k(3, 1, 2, 2) = kp22_4k(1, 3, 2, 2);
kp22_4k(3, 1, 2, 3) = kp22_4k(1, 3, 2, 3);
kp22_4k(3, 1, 3, 1) = kp22_4k(1, 3, 3, 1);
kp22_4k(3, 1, 3, 2) = kp22_4k(1, 3, 3, 2);
kp22_4k(3, 1, 3, 3) = kp22_4k(1, 3, 3, 3);

kp22_4k(3, 2, 1, 1) = kp22_4k(2, 3, 1, 1);
kp22_4k(3, 2, 1, 2) = kp22_4k(2, 3, 1, 2);
kp22_4k(3, 2, 1, 3) = kp22_4k(2, 3, 1, 3);
kp22_4k(3, 2, 2, 1) = kp22_4k(2, 3, 2, 1);
kp22_4k(3, 2, 2, 2) = kp22_4k(2, 3, 2, 2);
kp22_4k(3, 2, 2, 3) = kp22_4k(2, 3, 2, 3);
kp22_4k(3, 2, 3, 1) = kp22_4k(2, 3, 3, 1);
kp22_4k(3, 2, 3, 2) = kp22_4k(2, 3, 3, 2);
kp22_4k(3, 2, 3, 3) = kp22_4k(2, 3, 3, 3);

kp22_4k(3, 3, 1, 1) = kp22(3, 1);
kp22_4k(3, 3, 1, 2) = kp22(3, 4);
kp22_4k(3, 3, 1, 3) = kp22(3, 5);
kp22_4k(3, 3, 2, 1) = kp22(3, 4);
kp22_4k(3, 3, 2, 2) = kp22(3, 2);
kp22_4k(3, 3, 2, 3) = kp22(3, 6);
kp22_4k(3, 3, 3, 1) = kp22(3, 5);
kp22_4k(3, 3, 3, 2) = kp22(3, 6);
kp22_4k(3, 3, 3, 3) = kp22(3, 3);

kp114k = zeros(3, 3, 3, 3);
kp124k = zeros(3, 3, 3, 3);
kp214k = zeros(3, 3, 3, 3);
kp224k = zeros(3, 3, 3, 3);
for i = 1:3
    for j = 1:3
        for k = 1:3
            for l = 1:3
                for m = 1:3
                    for n = 1:3
                        for p = 1:3
                            for q = 1:3
                                kp114k(i, j, k, l) = kp114k(i, j, k, l) + a(i, m)*a(j, n)*a(k, p)*a(l, q)*kp11_4k(m, n, p, q);
                                kp124k(i, j, k, l) = kp124k(i, j, k, l) + a(i, m)*a(j, n)*a(k, p)*a(l, q)*kp12_4k(m, n, p, q);
                                kp214k(i, j, k, l) = kp214k(i, j, k, l) + a(i, m)*a(j, n)*a(k, p)*a(l, q)*kp21_4k(m, n, p, q);
                                kp224k(i, j, k, l) = kp224k(i, j, k, l) + a(i, m)*a(j, n)*a(k, p)*a(l, q)*kp22_4k(m, n, p, q);
                            end
                        end
                    end
                end
            end
        end
    end
end

kp11f = zeros(6, 6);
kp12f = zeros(6, 6);
kp21f = zeros(6, 6);
kp22f = zeros(6, 6);

kp11f = [kp114k(1, 1, 1, 1) kp114k(1, 1, 2, 2) kp114k(1, 1, 3, 3) kp114k(1, 1, 1, 2) kp114k(1, 1, 1, 3) kp114k(1, 1, 2, 3);
    kp114k(2, 2, 1, 1) kp114k(2, 2, 2, 2) kp114k(2, 2, 3, 3) kp114k(2, 2, 1, 2) kp114k(2, 2, 1, 3) kp114k(2, 2, 2, 3);
    kp114k(3, 3, 1, 1) kp114k(3, 3, 2, 2) kp114k(3, 3, 3, 3) kp114k(3, 3, 1, 2) kp114k(3, 3, 1, 3) kp114k(3, 3, 2, 3);
    kp114k(1, 2, 1, 1) kp114k(1, 2, 2, 2) kp114k(1, 2, 3, 3) kp114k(1, 2, 1, 2) kp114k(1, 2, 1, 3) kp114k(1, 2, 2, 3);
    kp114k(1, 3, 1, 1) kp114k(1, 3, 2, 2) kp114k(1, 3, 3, 3) kp114k(1, 3, 1, 2) kp114k(1, 3, 1, 3) kp114k(1, 3, 2, 3);
    kp114k(2, 3, 1, 1) kp114k(2, 3, 2, 2) kp114k(2, 3, 3, 3) kp114k(2, 3, 1, 2) kp114k(2, 3, 1, 3) kp114k(2, 3, 2, 3)];

kp12f = [kp124k(1, 1, 1, 1) kp124k(1, 1, 2, 2) kp124k(1, 1, 3, 3) kp124k(1, 1, 1, 2) kp124k(1, 1, 1, 3) kp124k(1, 1, 2, 3);
    kp124k(2, 2, 1, 1) kp124k(2, 2, 2, 2) kp124k(2, 2, 3, 3) kp124k(2, 2, 1, 2) kp124k(2, 2, 1, 3) kp124k(2, 2, 2, 3);
    kp124k(3, 3, 1, 1) kp124k(3, 3, 2, 2) kp124k(3, 3, 3, 3) kp124k(3, 3, 1, 2) kp124k(3, 3, 1, 3) kp124k(3, 3, 2, 3);
    kp124k(1, 2, 1, 1) kp124k(1, 2, 2, 2) kp124k(1, 2, 3, 3) kp124k(1, 2, 1, 2) kp124k(1, 2, 1, 3) kp124k(1, 2, 2, 3);
    kp124k(1, 3, 1, 1) kp124k(1, 3, 2, 2) kp124k(1, 3, 3, 3) kp124k(1, 3, 1, 2) kp124k(1, 3, 1, 3) kp124k(1, 3, 2, 3);
    kp124k(2, 3, 1, 1) kp124k(2, 3, 2, 2) kp124k(2, 3, 3, 3) kp124k(2, 3, 1, 2) kp124k(2, 3, 1, 3) kp124k(2, 3, 2, 3)];

kp21f = [kp214k(1, 1, 1, 1) kp214k(1, 1, 2, 2) kp214k(1, 1, 3, 3) kp214k(1, 1, 1, 2) kp214k(1, 1, 1, 3) kp214k(1, 1, 2, 3);
    kp214k(2, 2, 1, 1) kp214k(2, 2, 2, 2) kp214k(2, 2, 3, 3) kp214k(2, 2, 1, 2) kp214k(2, 2, 1, 3) kp214k(2, 2, 2, 3);
    kp214k(3, 3, 1, 1) kp214k(3, 3, 2, 2) kp214k(3, 3, 3, 3) kp214k(3, 3, 1, 2) kp214k(3, 3, 1, 3) kp214k(3, 3, 2, 3);
    kp214k(1, 2, 1, 1) kp214k(1, 2, 2, 2) kp214k(1, 2, 3, 3) kp214k(1, 2, 1, 2) kp214k(1, 2, 1, 3) kp214k(1, 2, 2, 3);
    kp214k(1, 3, 1, 1) kp214k(1, 3, 2, 2) kp214k(1, 3, 3, 3) kp214k(1, 3, 1, 2) kp214k(1, 3, 1, 3) kp214k(1, 3, 2, 3);
    kp214k(2, 3, 1, 1) kp214k(2, 3, 2, 2) kp214k(2, 3, 3, 3) kp214k(2, 3, 1, 2) kp214k(2, 3, 1, 3) kp214k(2, 3, 2, 3)];

kp22f = [kp224k(1, 1, 1, 1) kp224k(1, 1, 2, 2) kp224k(1, 1, 3, 3) kp224k(1, 1, 1, 2) kp224k(1, 1, 1, 3) kp224k(1, 1, 2, 3);
    kp224k(2, 2, 1, 1) kp224k(2, 2, 2, 2) kp224k(2, 2, 3, 3) kp224k(2, 2, 1, 2) kp224k(2, 2, 1, 3) kp224k(2, 2, 2, 3);
    kp224k(3, 3, 1, 1) kp224k(3, 3, 2, 2) kp224k(3, 3, 3, 3) kp224k(3, 3, 1, 2) kp224k(3, 3, 1, 3) kp224k(3, 3, 2, 3);
    kp224k(1, 2, 1, 1) kp224k(1, 2, 2, 2) kp224k(1, 2, 3, 3) kp224k(1, 2, 1, 2) kp224k(1, 2, 1, 3) kp224k(1, 2, 2, 3);
    kp224k(1, 3, 1, 1) kp224k(1, 3, 2, 2) kp224k(1, 3, 3, 3) kp224k(1, 3, 1, 2) kp224k(1, 3, 1, 3) kp224k(1, 3, 2, 3);
    kp224k(2, 3, 1, 1) kp224k(2, 3, 2, 2) kp224k(2, 3, 3, 3) kp224k(2, 3, 1, 2) kp224k(2, 3, 1, 3) kp224k(2, 3, 2, 3)];

kp2 = [kp11f kp12f; kp21f kp22f];
end